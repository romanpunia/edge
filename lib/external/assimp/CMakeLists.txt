#Resolve headers, refs and linkage
find_path(ASSIMP_LOCATION assimp/scene.h)
if (ASSIMP_LOCATION)
    if (NOT WIN32 OR NOT DEFINED ENV{VCPKG_ROOT} OR MSVC)
        target_include_directories(tomahawk PRIVATE ${ASSIMP_LOCATION})
        if (MSVC)
            find_package(assimp CONFIG QUIET)
        endif()
        if (NOT assimp_FOUND)
            find_library(assimp_FOUND "assimp")
            if (assimp_FOUND)
                set(ASSIMP_LIBRARIES "${assimp_FOUND}")
                target_compile_definitions(tomahawk PRIVATE -DTHAWK_HAS_ASSIMP)
            endif()
        else()
            target_compile_definitions(tomahawk PRIVATE -DTHAWK_HAS_ASSIMP)
        endif()
    else()
        message(WARNING "Assimp library by @vcpkg can be used on Windows only under MSVC")
    endif()
    if (assimp_FOUND OR ASSIMP_LIBRARIES)
        if (DEFINED ASSIMP_LIBRARIES AND NOT MSVC)
            string(STRIP "${ASSIMP_LIBRARIES}" ASSIMP_LIBRARIES)
            target_link_libraries(tomahawk PRIVATE ${ASSIMP_LIBRARIES})
            message(STATUS "Assimp library found")
        else()
            target_link_libraries(tomahawk PRIVATE assimp::assimp)
            message(STATUS "Assimp target library found")
        endif()
    else()
        message(WARNING "Assimp library was not found")
    endif()
else()
    message(WARNING "Assimp library was not found")
endif()

#Cleanup
unset(ASSIMP_LOCATION CACHE)
unset(assimp_FOUND CACHE)
unset(ASSIMP_LIBRARIES CACHE)